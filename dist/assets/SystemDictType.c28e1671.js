import{_ as R,r as m,o as h,a8 as g,w as l,aB as C,aC as N,f as t,h as u,E as P,b as z,c as B,bE as E,e as b,bD as T,c8 as Q,d as q,ab as G}from"./index.41bf9c1b.js";import{E as L}from"./el-pagination.1e9489f1.js";import{E as H,a as J}from"./el-table-column.4b985531.js";import"./el-select.1fc6c445.js";import{a as K}from"./el-popper.7ae0c7d7.js";import{E as W}from"./el-link.e79f8a31.js";/* empty css                       *//* empty css                   */import{f as X}from"./formatDate.66ef0a13.js";import{A as Z,a as $,b as ee,c as te,d as U}from"./index.0ddc6997.js";import"./el-collapse-transition.bb7c8a08.js";import{E as oe}from"./index.aa5a1392.js";import{E as A,a as I}from"./index.39967f43.js";import{E as le}from"./el-dialog.db387371.js";import{E as ne}from"./index.6f6ffc3e.js";import"./isEqual.f69c734a.js";import"./debounce.917afbd5.js";import"./index.01c8af0b.js";import"./strings.2f51a18b.js";import"./castArray.422477ef.js";import"./refs.90407178.js";const ae={props:["show"],emits:["onSearch"],data(){return{form:{name:"",type:""}}},methods:{handleReset(){this.$emit("onSearch",{}),this.$refs.formRef.resetFields()},handleSearch(){const o=Object.entries(this.form).reduce((e,[d,_])=>(_!==""&&(e[d]=_),e),{});this.$emit("onSearch",o)}}};function se(o,e,d,_,n,a){const f=P,p=A,i=m("Search"),c=z,y=B,r=m("Refresh"),x=I,V=oe;return h(),g(V,null,{default:l(()=>[C(t(x,{class:"sys-filters",ref:"formRef",inline:"",model:n.form},{default:l(()=>[t(p,{label:"\u5B57\u5178\u540D\u79F0",prop:"name"},{default:l(()=>[t(f,{placeholder:"\u8BF7\u8F93\u5165\u5B57\u5178\u540D\u79F0",clearable:"",modelValue:n.form.name,"onUpdate:modelValue":e[0]||(e[0]=k=>n.form.name=k)},null,8,["modelValue"])]),_:1}),t(p,{label:"\u7C7B\u578B\u7F16\u7801",prop:"type"},{default:l(()=>[t(f,{placeholder:"\u8BF7\u8F93\u5165\u7C7B\u578B\u7F16\u7801",clearable:"",modelValue:n.form.type,"onUpdate:modelValue":e[1]||(e[1]=k=>n.form.type=k)},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(y,{type:"primary",onClick:a.handleSearch},{default:l(()=>[t(c,null,{default:l(()=>[t(i)]),_:1}),u(" \u641C\u7D22 ")]),_:1},8,["onClick"]),t(y,{onClick:a.handleReset},{default:l(()=>[t(c,null,{default:l(()=>[t(r)]),_:1}),u(" \u91CD\u7F6E ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),[[N,d.show]])]),_:1})}const re=R(ae,[["render",se]]),ie={props:["modelValue","type","ids"],emits:["update:modelValue","onSubmit"],data(){return{form:{name:"",type:"",remarks:""},rules:{name:[{required:!0,message:"\u5B57\u5178\u540D\u79F0\u4E3A\u5FC5\u586B\u9879",trigger:"blur"},{min:1,message:"\u5B57\u5178\u540D\u79F0\u4E3A\u5FC5\u586B\u9879",trigger:"blur"}],type:[{required:!0,message:"\u5B57\u5178\u7C7B\u578B\u4E3A\u5FC5\u586B\u9879",trigger:"blur"},{min:1,message:"\u5B57\u5178\u7C7B\u578B\u4E3A\u5FC5\u586B\u9879",trigger:"blur"}]}}},computed:{show:{get(){return this.modelValue},set(o){this.$emit("update:modelValue",o)}},title(){return this.type===1?"\u6DFB\u52A0\u5B57\u5178\u7C7B\u578B":"\u4FEE\u6539\u5B57\u5178\u7C7B\u578B"}},methods:{async init(){if(this.type===2){const o=await Z({id:this.ids[0]});Object.assign(this.form,o)}},async invokeCreate(){const{name:o,type:e,remarks:d}=this.form;await $({name:o,type:e,remarks:d}),E.success("\u6DFB\u52A0\u5B57\u5178\u6210\u529F")},async invokeUpdate(o){const{name:e,type:d,remarks:_}=this.form;await ee({id:o,name:e,type:d,remarks:_}),E.success("\u4FEE\u6539\u5B57\u5178\u6210\u529F")},async onSubmit(){try{const{formRef:e}=this.$refs;await e.validate()}catch{return}const{type:o}=this;if(o===1)await this.invokeCreate();else if(o===2)await this.invokeUpdate(this.ids[0]);else if(o===3)await Promise.all(this.ids.map(this.invokeUpdate));else return console.error("SystemDict->EditorDialog->onSubmit: \u672A\u77E5\u7684\u64CD\u4F5C\u7C7B\u578B "+o);this.onCancel(),this.$emit("onSubmit")},onCancel(){const{formRef:o}=this.$refs;this.show=!1,o.resetFields()}},watch:{show:{immediate:!0,handler(o){o&&this.init()}}}},ce={class:"dialog-footer"};function me(o,e,d,_,n,a){const f=P,p=A,i=I,c=B,y=le;return h(),g(y,{modelValue:a.show,"onUpdate:modelValue":e[3]||(e[3]=r=>a.show=r),title:a.title,width:"600px","append-to-body":!0,"destroy-on-close":!0,"before-close":a.onCancel},{default:l(()=>[t(i,{ref:"formRef",model:n.form,rules:n.rules,"label-width":"90px",class:"form"},{default:l(()=>[t(p,{label:"\u5B57\u5178\u540D\u79F0",prop:"name"},{default:l(()=>[t(f,{modelValue:n.form.name,"onUpdate:modelValue":e[0]||(e[0]=r=>n.form.name=r),placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(p,{label:"\u7C7B\u578B\u7F16\u7801",prop:"type"},{default:l(()=>[t(f,{modelValue:n.form.type,"onUpdate:modelValue":e[1]||(e[1]=r=>n.form.type=r),placeholder:"\u8BF7\u8F93\u5165\u7C7B\u578B\u7F16\u7801"},null,8,["modelValue"])]),_:1}),t(p,{label:"\u5907\u6CE8",prop:"remarks"},{default:l(()=>[t(f,{modelValue:n.form.remarks,"onUpdate:modelValue":e[2]||(e[2]=r=>n.form.remarks=r),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",maxlength:200,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),footer:l(()=>[b("span",ce,[t(c,{onClick:a.onCancel},{default:l(()=>[u("\u53D6\u6D88")]),_:1},8,["onClick"]),t(c,{type:"primary",onClick:a.onSubmit},{default:l(()=>[u(" \u786E\u8BA4 ")]),_:1},8,["onClick"])])]),_:1},8,["modelValue","title","before-close"])}const de=R(ie,[["render",me]]),pe={data(){return{showSearch:!0,editorBox:{show:!1,ids:[],type:1},tableData:[],pageIndex:1,pageSize:10,count:2}},computed:{checkedAll:{get(){return this.tableData.length===0?!1:this.tableData.every(e=>e.checked)},set(o){this.tableData.forEach(e=>e.checked=o)}},selectedRows(){return this.tableData.filter(o=>o.checked)},shouldDisableBatch(){return this.selectedRows.length===0}},methods:{async init(){const o=await te({current:this.pageIndex,size:this.pageSize,...this.searchQuery});o.records.forEach(e=>{e.checked=!1,e.createTime=X("YYYY-MM-DD",e.createTime)}),this.count=o.total,this.tableData=o.records},async onRemoveRow({id:o}){T.confirm("\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u5B57\u5178\u7C7B\u578B\u5417 ?","\u7CFB\u7EDF\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>U({id:o})).then(()=>{E.success("\u5220\u9664\u6210\u529F"),this.init()}).catch(()=>null)},async onBatchRemoveRow(){T.confirm("\u60A8\u786E\u5B9A\u8981\u6279\u91CF\u5220\u9664\u9009\u4E2D\u7684\u5B57\u5178\u7C7B\u578B\u5417 ?","\u7CFB\u7EDF\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>Promise.all(this.selectedRows.map(({id:o})=>U({id:o})))).then(()=>{E.success("\u6279\u91CF\u5220\u9664\u6210\u529F"),this.init()}).catch(()=>null)},onEditorChange(o,e=[]){o===2&&(e=[e]),this.editorBox.show=!0,this.editorBox.ids=e,this.editorBox.type=o},onPageChange(o,e){this.init()},onSearch(o){this.searchQuery=o,this.init()}},components:{Filters:re,DictTypeEditorDialog:de},created(){this.searchQuery={},this.init()}},ue={class:"SystemDictType"},fe={class:"sys-table-action"},he={class:"sys-table-main-actions"},_e={class:"sys-table-footer"},ye=b("div",null,null,-1);function ge(o,e,d,_,n,a){const f=m("Filters"),p=m("Plus"),i=z,c=B,y=m("Delete"),r=m("Search"),x=K,V=m("RefreshRight"),k=ne,w=H,F=m("router-link"),D=W,O=m("EditPen"),M=J,Y=L,j=m("DictTypeEditorDialog"),S=Q("auth");return h(),q("div",ue,[t(f,{show:n.showSearch,onOnSearch:a.onSearch},null,8,["show","onOnSearch"]),b("section",fe,[b("div",null,[C((h(),g(c,{type:"primary",onClick:e[0]||(e[0]=s=>a.onEditorChange(1))},{default:l(()=>[t(i,null,{default:l(()=>[t(p)]),_:1}),u(" \u65B0\u589E ")]),_:1})),[[S,"system:dicttype:add"]]),C((h(),g(c,{type:"danger",disabled:a.shouldDisableBatch,onClick:a.onBatchRemoveRow},{default:l(()=>[t(i,null,{default:l(()=>[t(y)]),_:1}),u(" \u5220\u9664 ")]),_:1},8,["disabled","onClick"])),[[S,"system:dicttype:delete"]])]),b("div",null,[t(x,{class:"box-item",effect:"dark",content:`${n.showSearch?"\u9690\u85CF":"\u663E\u793A"}\u641C\u7D22`,placement:"top"},{default:l(()=>[t(c,{circle:"",plain:"",onClick:e[1]||(e[1]=s=>n.showSearch=!n.showSearch)},{default:l(()=>[t(i,null,{default:l(()=>[t(r)]),_:1})]),_:1})]),_:1},8,["content"]),t(x,{class:"box-item",effect:"dark",content:"\u5237\u65B0\u8868\u683C",placement:"top"},{default:l(()=>[t(c,{circle:"",plain:"",onClick:a.init},{default:l(()=>[t(i,null,{default:l(()=>[t(V)]),_:1})]),_:1},8,["onClick"])]),_:1})])]),C((h(),g(M,{data:n.tableData,stripe:"",border:""},{default:l(()=>[t(w,{width:"40"},{header:l(()=>[t(k,{modelValue:a.checkedAll,"onUpdate:modelValue":e[2]||(e[2]=s=>a.checkedAll=s)},null,8,["modelValue"])]),default:l(({row:s})=>[t(k,{modelValue:s.checked,"onUpdate:modelValue":v=>s.checked=v},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(w,{prop:"name",label:"\u5B57\u5178\u540D\u79F0",align:"center"}),t(w,{prop:"type",label:"\u7C7B\u578B\u7F16\u7801",align:"center"},{default:l(({row:s})=>[t(D,{type:"primary",underline:!1},{default:l(()=>[t(F,{to:`/system/dict-item?type=${s.type}`},{default:l(()=>[u(G(s.type),1)]),_:2},1032,["to"])]),_:2},1024)]),_:1}),t(w,{prop:"remarks",label:"\u5B57\u5178\u63CF\u8FF0",align:"center"}),t(w,{prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4",align:"center"}),t(w,{label:"\u64CD\u4F5C",align:"center"},{default:l(({row:s})=>[b("div",he,[C((h(),g(D,{type:"primary",underline:!1,onClick:v=>a.onEditorChange(2,s.id)},{default:l(()=>[t(i,null,{default:l(()=>[t(O)]),_:1}),u(" \u4FEE\u6539 ")]),_:2},1032,["onClick"])),[[S,"system:dicttype:update"]]),C((h(),g(D,{type:"danger",underline:!1,style:{margin:"0 0 0 4px"},onClick:v=>a.onRemoveRow(s)},{default:l(()=>[t(i,null,{default:l(()=>[t(y)]),_:1}),u(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[S,"system:dicttype:delete"]])])]),_:1})]),_:1},8,["data"])),[[S,"system:dicttype:page"]]),b("div",_e,[ye,t(Y,{currentPage:n.pageIndex,"onUpdate:currentPage":e[3]||(e[3]=s=>n.pageIndex=s),"page-size":n.pageSize,"onUpdate:pageSize":e[4]||(e[4]=s=>n.pageSize=s),"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:n.count,onSizeChange:e[5]||(e[5]=s=>a.onPageChange(n.pageIndex,s)),onCurrentChange:e[6]||(e[6]=s=>a.onPageChange(s,n.pageSize))},null,8,["currentPage","page-size","total"])]),t(j,{modelValue:n.editorBox.show,"onUpdate:modelValue":e[7]||(e[7]=s=>n.editorBox.show=s),type:n.editorBox.type,ids:n.editorBox.ids,onOnSubmit:a.init},null,8,["modelValue","type","ids","onOnSubmit"])])}const Ye=R(pe,[["render",ge]]);export{Ye as default};
