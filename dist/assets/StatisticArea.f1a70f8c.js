import{bh as D,bi as x,_ as L,r as g,o as f,a8 as I,w as r,aB as R,aC as z,f as a,h as E,b as k,c as A,d as S,e as i,F as V,aA as F,aa as B,U as O,ab as Y,p as P,i as j}from"./index.41bf9c1b.js";import{E as M,a as N}from"./el-table-column.4b985531.js";import"./el-popper.7ae0c7d7.js";import{h as T}from"./moment.40bc58bf.js";import"./el-collapse-transition.bb7c8a08.js";import{E as U}from"./el-date-picker.79f6dda8.js";import{E as W}from"./el-cascader-panel.2166484a.js";import"./el-radio.4d7862e0.js";import{u as w}from"./EnumGlobalStore.f9b8c63d.js";import{E as q}from"./index.aa5a1392.js";import{E as G,a as H}from"./index.39967f43.js";import{f as J,u as K}from"./unfinish.f0210631.js";import{i as X}from"./index.1547a38d.js";import{t as Z}from"./title_icon.c98d738b.js";import{E as Q}from"./index.f21014bc.js";import"./isEqual.f69c734a.js";import"./debounce.917afbd5.js";import"./index.6f6ffc3e.js";import"./index.56404ca9.js";import"./strings.2f51a18b.js";import"./cloneDeep.6e207ca9.js";import"./index.01c8af0b.js";import"./index.5d666713.js";import"./castArray.422477ef.js";const $=e=>D({url:"/statistics/selectAreaEnergyContrast",loading:!0,data:e});const ee={props:["show"],emits:["onSearch"],data(){return{selectedValue:[],props:{multiple:!0},system_area:[],form:{areaList:"",startTime:"",endTime:""},statusList:[{value:"1",label:"\u5DF2\u4E0A\u62A5"},{value:"0",label:"\u672A\u4E0A\u62A5"}]}},methods:{...x(w,["resolveDictItemEnum"]),async init(){const e=await this.resolveDictItemEnum(["system_area"]);Object.assign(this,e)},handleReset(){this.$emit("onSearch",{areaList:"",startTime:"",endTime:""}),this.$refs.formRef.resetFields()},handleSearch(){const e=Object.entries(this.form).reduce((t,[s,p])=>(p!==""&&(t[s]=p),t),{});this.$emit("onSearch",e)}},created(){this.init()}};function te(e,t,s,p,o,l){const b=W,c=G,d=U,y=g("Search"),n=k,_=A,u=g("Refresh"),m=H,v=q;return f(),I(v,null,{default:r(()=>[R(a(m,{class:"sys-filters",ref:"formRef",inline:"",model:o.form},{default:r(()=>[a(c,{label:"\u5BF9\u6BD4\u533A\u57DF",prop:"areaList"},{default:r(()=>[a(b,{options:o.system_area,props:{multiple:!0,checkStrictly:!0,value:"v",label:"k"},clearable:"",modelValue:o.form.areaList,"onUpdate:modelValue":t[0]||(t[0]=h=>o.form.areaList=h)},null,8,["options","modelValue"])]),_:1}),a(c,{label:"\u5F00\u59CB\u6708\u4EFD",prop:"startTime"},{default:r(()=>[a(d,{modelValue:o.form.startTime,"onUpdate:modelValue":t[1]||(t[1]=h=>o.form.startTime=h),type:"month",placeholder:"\u9009\u62E9\u6708",clearable:""},null,8,["modelValue"])]),_:1}),a(c,{label:"\u7ED3\u675F\u6708\u4EFD",prop:"endTime"},{default:r(()=>[a(d,{modelValue:o.form.endTime,"onUpdate:modelValue":t[2]||(t[2]=h=>o.form.endTime=h),type:"month",placeholder:"\u9009\u62E9\u6708",clearable:""},null,8,["modelValue"])]),_:1}),a(c,null,{default:r(()=>[a(_,{type:"primary",onClick:l.handleSearch},{default:r(()=>[a(n,null,{default:r(()=>[a(y)]),_:1}),E(" \u67E5\u8BE2 ")]),_:1},8,["onClick"]),a(_,{onClick:l.handleReset},{default:r(()=>[a(n,null,{default:r(()=>[a(u)]),_:1}),E(" \u91CD\u7F6E ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),[[z,s.show]])]),_:1})}const ae=L(ee,[["render",te],["__scopeId","data-v-ae45b56c"]]);const se={data(){return{monthLabel:"\u9009\u5B9A\u6708\u4EFD\u80FD\u8017",thStyle:{color:"#9E9FA0",fontWeight:"100"},finish:J,unfinish:K,showSearch:!0,editorBox:{show:!1,type:1,ids:[]},uploadBox:{show:!1},tableData:[],pageIndex:1,pageSize:10,count:2,hover:0,commandStats:[120,400,59,112,23],type:"\u6C34",energy_type:[],titleIcon:Z,areaList:[]}},computed:{checkedAll:{get(){const e=this.tableData;return e.length===0?!1:e.every(t=>t.checked)},set(e){this.tableData.forEach(t=>t.checked=e)}},selectedRows(){return this.tableData.filter(e=>e.checked)},shouldDisabled(){return this.selectedRows.length===0}},methods:{...x(w,["resolveDictItemEnum"]),async getEnergyType(){const e=await this.resolveDictItemEnum(["energy_type"]);Object.assign(this,e)},async init(){const e=await $({...this.searchQuery,current:this.pageIndex,size:this.pageSize,type:this.type});this.pageIndex=1,this.pageSize=this.pageSize,this.total=e.length,this.tableData=e.map(t=>({area:t.area!="\u5C0F\u8BA1"?this.areaFormat(t.area):t.area,amountSum:t.amountSum,percentage:t.percentage!="NaN"&&t.percentage?t.percentage+"%":t.area!="\u5C0F\u8BA1"?0+"%":"0%"})),this.initeCharts()},async getSystemArea(){const e=await this.resolveDictItemEnum(["system_area"]);Object.assign(this,e)},areaFormat(e){let t="";return this.system_area.forEach(s=>{e==s.v&&(t=s.k)}),t},onSearch(e){var t={};e.areaList==""?(this.tableData=[],this.searchQuery={},this.monthLabel="\u9009\u5B9A\u6708\u4EFD\u80FD\u8017",this.initeCharts()):(e.areaList&&(t.areaList=e.areaList.map(s=>s[0]).join(",")),this.areaList=e.areaList,e.startTime&&(t.startTime=T(e.startTime).format("YYYY-MM")),e.endTime&&(t.endTime=T(e.endTime).format("YYYY-MM")),this.searchQuery=t,this.monthLabel=`${t.startTime}~${t.endTime}`,this.init())},onPageChange(e,t){this.init()},indexAdd(e){return e+1+(this.pageIndex-1)*this.pageSize},changeTab(e,t){this.hover=e,this.type=t,this.init()},initeCharts(){var e,t;this.companyRef=X(this.$refs.companyRef,"macarons"),this.tableData.length?(this.companyRef.resize({height:this.areaList.length>10?500:300}),this.companyRef.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} "},grid:{left:"1%",top:"1%",right:"1%",bottom:"1%",containLabel:!0},series:[{name:"\u533A\u57DF\u80FD\u8017\u5BF9\u6BD4",type:"pie",radius:[20,60],center:["50%",((t=(e=this.searchQuery)==null?void 0:e.areaList)==null?void 0:t.length)>10?"20%":"50%"],top:0,left:"center",itemStyle:{borderColor:"#fff",borderWidth:1},label:{alignTo:"edge",formatter:s=>(console.log("\u6B64\u65F6params",s),s.name!==""?`{name|${s.name}}

{value|${s.percent===void 0?0:s.percent}%}`:""),minMargin:5,edgeDistance:10,lineHeight:15,rich:{time:{fontSize:10,color:"#999"}}},labelLine:{length:15,length2:0,maxSurfaceAngle:80},data:this.tableData.map(s=>{if(s.area!="\u5C0F\u8BA1")return{name:s.area,value:s.amountSum}})}]},!0)):(this.companyRef.resize({height:this.areaList.length>10?500:300}),this.companyRef.setOption({title:{text:"\u6682\u65E0\u6570\u636E",x:"center",y:"center",textStyle:{fontSize:12,fontWeight:"normal",color:"#909399"}}},!0))}},components:{Filters:ae},created(){this.getSystemArea()},mounted(){this.initeCharts(),this.getEnergyType()}},C=e=>(P("data-v-1dba3ac2"),e=e(),j(),e),oe={class:"SystemPost"},re={class:"table-content"},ne={class:"box-card"},ie={class:"card-header"},le=C(()=>i("span",{class:"card-title"}," \u533A\u57DF\u80FD\u8017\u5BF9\u6BD4",-1)),ce={class:"type"},me=["onClick"],he=C(()=>i("div",{class:"hr"},null,-1));function pe(e,t,s,p,o,l){const b=g("Filters"),c=g("Picture"),d=k,y=Q,n=M,_=N;return f(),S("div",oe,[a(b,{show:o.showSearch,onOnSearch:l.onSearch},null,8,["show","onOnSearch"]),i("div",re,[i("div",ne,[i("div",ie,[a(y,{src:o.titleIcon,class:"img"},{error:r(()=>[a(d,null,{default:r(()=>[a(c)]),_:1})]),_:1},8,["src"]),le]),i("div",ce,[(f(!0),S(V,null,F(o.energy_type,(u,m)=>(f(),S("text",{class:O(m==o.hover?"hover":""),key:m,onClick:v=>l.changeTab(m,u.v)},Y(u.k),11,me))),128))]),i("div",{ref:"companyRef",style:B(`height:${o.tableData.length?o.areaList.length>10?"500":"300":"200"}px`)},null,4)]),he,a(_,{data:o.tableData,stripe:"","header-cell-style":o.thStyle},{default:r(()=>[a(n,{width:"80",index:l.indexAdd,label:"\u5E8F\u53F7",align:"center",type:"index"},null,8,["index"]),a(n,{width:"200",prop:"area",label:"\u533A\u57DF",align:"center"}),a(n,{prop:"amountSum",label:o.monthLabel,align:"center"},null,8,["label"]),a(n,{prop:"percentage",label:"\u767E\u5206\u6BD4",align:"center"})]),_:1},8,["data","header-cell-style"])])])}const Oe=L(se,[["render",pe],["__scopeId","data-v-1dba3ac2"]]);export{Oe as default};
